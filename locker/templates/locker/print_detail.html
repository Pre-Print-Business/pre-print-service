{% extends 'base.html' %}
{% load static %}
{% block title %}ì‚¬ë¬¼í•¨ ëŒ€ì—¬{% endblock %}

{% block content %}
<div class="locker-container">
    <div class="two-sections">
        <div class="left-section">
            <h1 style="text-align: center;">ì‚¬ë¬¼í•¨ í˜„í™©</h1>
            {% if messages %}
                <div class="alert alert-danger">
                    {% for message in messages %}
                        <p>{{ message }}</p>
                    {% endfor %}
                </div>
            {% endif %}

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-box available"></div> ì‚¬ìš© ê°€ëŠ¥í•œ ì‚¬ë¬¼í•¨
                </div>
                <div class="legend-item">
                    <div class="legend-box unavailable"></div> ì‚¬ìš© ë¶ˆê°€ëŠ¥í•œ ì‚¬ë¬¼í•¨
                </div>
            </div>

            <div class="locker-grid">
                {% for locker in lockers %}
                    <div class="locker-box {% if locker.is_using %}unavailable{% else %}available{% endif %}" 
                         data-locker-id="{{ locker.id }}">
                        {{ locker.locker_number }}
                    </div>
                {% endfor %}
            </div>
            <br>
            <div class="alert alert-info">
                <strong>â€» ìœ„ ì‚¬ë¬¼í•¨ ì •ë³´ì—ì„œ ëŒ€ì—¬í•˜ì‹¤ ì‚¬ë¬¼í•¨ì„ í´ë¦­í•´ì£¼ì„¸ìš”. <br>
                    â€» ì‚¬ë¬¼í•¨ ìƒ‰ì´ íšŒìƒ‰ì¸ ê²½ìš° ì´ë¯¸ ê²°ì œí•˜ì—¬ ì‚¬ìš©í•˜ê³  ìˆëŠ” ì‚¬ë¬¼í•¨ì…ë‹ˆë‹¤.</strong>
            </div>
        </div>

        <div class="right-section">
            <h1 style="text-align: center; margin-bottom:20px;">ê²°ì œ ì •ë³´</h1>
            <form action="" method="POST" class="locker-form">
                {% csrf_token %}
                
                <div class="form-row">
                    <label for="locker_id">ì„ íƒí•œ ì‚¬ë¬¼í•¨:</label>
                    <input type="text" id="locker_id" name="locker_id" readonly required placeholder="ì‚¬ë¬¼í•¨ ë²ˆí˜¸ ì„ íƒ">
                </div>

                <div class="form-row">
                    <label for="plan">ì´ìš©ê¶Œ ì„ íƒ:</label>
                    <select id="plan" name="plan" style="height: auto; padding: 8px;">
                        <option value="semester">ğŸ“ 2í•™ê¸°ê¶Œ(ë°©í•™í¬í•¨) - 4ê°œì›” í•™ê¸°ê¶Œ êµ¬ë§¤í•˜ë©´ ë°©í•™ì „ì²´ê¸°ê°„ ë¬´ë£Œ 2ê°œì›” ì¶”ê°€! âœ¨ (2025.09.01 ~ 2026.02.25, 177ì¼, 30,000ì›)</option>
                        <option value="long">ğŸ’ 1ë…„ê¶Œ - ìµœëŒ€ ì ˆì•½! ì¥ê¸° ì´ìš©ì‹œ í˜œíƒ ê°€ë“! ğŸ“š (2025.09.01 ~ 2026.08.28, 361ì¼, 55,000ì›)</option>
                    </select>
                </div>

                <div class="form-row">
                    <label for="locker_pw">ì‚¬ë¬¼í•¨ ë¹„ë°€ë²ˆí˜¸ (4ìë¦¬ ìˆ«ì):</label>
                    <input type="text" id="locker_pw" name="locker_pw" pattern="\d{4}" maxlength="4" required placeholder="ì˜ˆ: 1234">
                </div>

                <button type="submit" class="btn btn-primary btn-same-width">ëŒ€ì—¬ ì‹ ì²­</button>
            </form>
            <br>
            <div class="alert alert-warning">
                <strong>â€» ê²°ì œì§í›„ ë°”ë¡œ í•™ìƒíšŒê´€ 1ì¸µ ì‚¬ë¬¼í•¨ í˜„ì¥ì—ì„œ pwì„¤ì •í›„ ì‚¬ìš©ê°€ëŠ¥í•©ë‹ˆë‹¤.</strong><br>
                <strong>â€» ìœ„ ì…ë ¥í•˜ì‹  ì‚¬ë¬¼í•¨ ë¹„ë°€ë²ˆí˜¸ë¡œ í˜„ì¥ì—ì„œ ì‚¬ë¬¼í•¨ pwë¥¼ ì„¤ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤. <a href="{% url 'document_locker_password_guide' %}" class="text-primary">(ì‚¬ë¬¼í•¨ pwì„¤ì • ê°€ì´ë“œ)</a></strong>
                <strong>â€» pwì„¤ì • ë°©ë²•ì€ ìƒë‹¨ "ì‚¬ë¬¼í•¨ pwì„¤ì • ê°€ì´ë“œ"ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.</strong><br>
            </div>
            <div class="alert alert-info">
                <strong>â€» 09.01ì¼ ì´í›„ ê²°ì œí•˜ì‹œëŠ” ê²½ìš°, ì§€ë‚œ ì¼ìˆ˜ë‹¹ 170ì›ì”© í• ì¸ë©ë‹ˆë‹¤ (ìµœëŒ€ 14ì¼ê¹Œì§€ë§Œ ì ìš©).<br>
                   ì˜ˆ: 09.06ì¼ ê²°ì œ ì‹œ, ì‚¬ìš©í•˜ì§€ ëª»í•œ ê¸°ê°„ 5ì¼ Ã— 170ì› = 850ì›ì´ í• ì¸ë˜ì–´ ìµœì¢… ê²°ì œê¸ˆì•¡ì´ ì°¨ê°ë©ë‹ˆë‹¤.</strong>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        document.querySelectorAll(".locker-box.available").forEach(box => {
            box.addEventListener("click", function() {
                document.querySelectorAll(".locker-box").forEach(b => b.classList.remove("selected"));
                this.classList.add("selected");
                document.getElementById("locker_id").value = this.dataset.lockerId;
            });
        });

        document.querySelector(".locker-form").addEventListener("submit", function(e) {
            const lockerId = document.getElementById("locker_id").value;
            if (!lockerId) {
                e.preventDefault();
                alert("ì‚¬ë¬¼í•¨ì„ ì„ íƒí•´ ì£¼ì„¸ìš”!");
                return false;
            }
        });
    });
</script>

<style>
    .locker-box.selected {
        background-color: #007bff !important;
        color: white !important;
        border: 2px solid #0056b3 !important;
    }
</style>
{% endblock %}
