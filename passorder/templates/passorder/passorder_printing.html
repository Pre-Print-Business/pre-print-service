{% extends 'base.html' %}
{% load static %}
{% block title %}패스오더 프린팅{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="text-center mb-4">
        <h1 class="fw-bold display-5">패스오더 프린트</h1>
        <p class="text-muted">주문 번호: <strong>{{ order.id }}</strong></p>
    </div>

    <div class="row justify-content-center">
        <div class="col-md-8">
            <h3 class="fw-bold">출력할 파일 목록</h3>
            {% if files %}
                <ul class="list-group">
                    {% for file in files %}
                        <li class="list-group-item">
                            <a href="{{ file.pass_order_file.url }}" target="_blank">{{ file.pass_order_file.name }}</a>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p class="text-muted">첨부된 파일이 없습니다.</p>
            {% endif %}

            <div class="alert alert-danger mt-4 text-center border-0 shadow-sm">
                <i class="fas fa-exclamation-circle fs-4 mb-2 text-danger"></i>
                <div class="fw-bold fs-5 mb-1">중요 안내</div>
                <div class="fs-6">한 번 출력하면 되돌릴 수 없습니다. 신중하게 진행하세요.</div>
            </div>

            <div class="card border-warning shadow-sm mt-4 mb-4">
                <div class="card-header bg-warning bg-opacity-10 border-warning text-center py-3">
                    <i class="fas fa-hand-paper fs-2 text-warning mb-2"></i>
                    <h4 class="fw-bold text-warning mb-0">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        출력 전 필수 확인사항
                    </h4>
                </div>
                <div class="card-body text-center py-4">
                    <p class="fs-5 fw-bold text-dark mb-2">
                        출력하기 버튼 클릭 전, <span class="text-danger">꼭!</span>
                    </p>
                    <p class="fs-6 mb-3">
                        <strong>복합기 스크린을 터치</strong>하여 
                        <span class="bg-danger text-white px-2 py-1 rounded">오류알림이 없는지</span> 
                        확인하시고 출력하기 버튼을 클릭해주세요.
                    </p>
                    <div class="alert alert-info mb-0 py-2">
                        <i class="fas fa-lightbulb me-2"></i>
                        <small>복합기에 오류가 있으면 출력이 실패할 수 있습니다!</small>
                    </div>
                </div>
            </div>

            <div class="text-center">
                <form method="post" action="{% url 'passorder:passorder_printing' %}" id="printForm">
                    {% csrf_token %}
                    <input type="hidden" name="order_id" value="{{ order.id }}">
                    <button type="button" class="btn btn-primary btn-lg px-5" onclick="confirmPrint()">출력하기</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra-script %}
<script>
function confirmPrint() {
    showConfirmModal(
        '복합기 스크린 터치후 오류가 없는 상황인지 꼭 확인해주세요.', 
        function() {
            document.getElementById('printForm').submit();
        }
    );
}
</script>
{% endblock %}
